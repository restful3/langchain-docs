"""
================================================================================
LangChain AI Agent ë§ˆìŠ¤í„° êµì•ˆ
Part 2: LangChain ê¸°ì´ˆ
================================================================================

íŒŒì¼ëª…: 03_tools_basic.py
ë‚œì´ë„: â­â­â˜†â˜†â˜† (ì´ˆê¸‰)
ì˜ˆìƒ ì‹œê°„: 20ë¶„

ğŸ“š í•™ìŠµ ëª©í‘œ:
  - Toolì˜ ê°œë… ì´í•´
  - @tool ë°ì½”ë ˆì´í„° ì‚¬ìš©ë²•
  - ë„êµ¬ ì •ì˜ ë° ì‹¤í–‰

ğŸ“– ê³µì‹ ë¬¸ì„œ:
  â€¢ Tools: /official/09-tools.md

ğŸš€ ì‹¤í–‰ ë°©ë²•:
  python 03_tools_basic.py

================================================================================
"""

from langchain.tools import tool
from typing import Optional

# ============================================================================
# ì˜ˆì œ 1: ê°€ì¥ ê°„ë‹¨í•œ Tool
# ============================================================================

@tool
def get_current_time() -> str:
    """í˜„ì¬ ì‹œê°„ì„ ì•Œë ¤ì¤ë‹ˆë‹¤."""
    from datetime import datetime
    return datetime.now().strftime("%Y-%m-%d %H:%M:%S")


def example_1_simple_tool():
    """ê°€ì¥ ê°„ë‹¨í•œ ë„êµ¬ ì •ì˜"""
    print("=" * 70)
    print("ğŸ“Œ ì˜ˆì œ 1: ê°€ì¥ ê°„ë‹¨í•œ Tool")
    print("=" * 70)

    # Tool ì •ë³´ í™•ì¸
    print(f"\nğŸ”§ ë„êµ¬ ì´ë¦„: {get_current_time.name}")
    print(f"ğŸ“ ë„êµ¬ ì„¤ëª…: {get_current_time.description}")

    # Tool ì‹¤í–‰
    result = get_current_time.invoke({})
    print(f"â° í˜„ì¬ ì‹œê°„: {result}\n")


# ============================================================================
# ì˜ˆì œ 2: íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” Tool
# ============================================================================

@tool
def calculate_age(birth_year: int) -> str:
    """íƒœì–´ë‚œ ë…„ë„ë¥¼ ì…ë ¥ë°›ì•„ ë‚˜ì´ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.

    Args:
        birth_year: íƒœì–´ë‚œ ë…„ë„ (ì˜ˆ: 1990)
    """
    from datetime import datetime
    current_year = datetime.now().year
    age = current_year - birth_year
    return f"{birth_year}ë…„ìƒì€ ë§Œ {age}ì„¸ì…ë‹ˆë‹¤."


def example_2_tool_with_params():
    """íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” ë„êµ¬"""
    print("=" * 70)
    print("ğŸ“Œ ì˜ˆì œ 2: íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” Tool")
    print("=" * 70)

    # Tool ì •ë³´
    print(f"\nğŸ”§ ë„êµ¬ ì´ë¦„: {calculate_age.name}")
    print(f"ğŸ“ ë„êµ¬ ì„¤ëª…: {calculate_age.description}")
    print(f"ğŸ“‹ íŒŒë¼ë¯¸í„°: {calculate_age.args}")

    # Tool ì‹¤í–‰
    result = calculate_age.invoke({"birth_year": 1990})
    print(f"\nğŸ’¡ ê²°ê³¼: {result}\n")


# ============================================================================
# ì˜ˆì œ 3: ì‹¤ìš©ì ì¸ Tool - ë‚ ì”¨
# ============================================================================

@tool
def get_weather(city: str) -> str:
    """ì£¼ì–´ì§„ ë„ì‹œì˜ ë‚ ì”¨ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.

    Args:
        city: ë„ì‹œ ì´ë¦„ (ì˜ˆ: ì„œìš¸, ë¶€ì‚°, ë‰´ìš•)
    """
    # ì‹¤ì œë¡œëŠ” APIë¥¼ í˜¸ì¶œí•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ë”ë¯¸ ë°ì´í„°
    weather_data = {
        "ì„œìš¸": "ë§‘ìŒ, 22ë„",
        "ë¶€ì‚°": "íë¦¼, 20ë„",
        "ë‰´ìš•": "ë¹„, 15ë„",
    }

    weather = weather_data.get(city, "ë‚ ì”¨ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    return f"{city}ì˜ ë‚ ì”¨ëŠ” {weather}ì…ë‹ˆë‹¤."


def example_3_practical_tool():
    """ì‹¤ìš©ì ì¸ ë„êµ¬ ì˜ˆì œ"""
    print("=" * 70)
    print("ğŸ“Œ ì˜ˆì œ 3: ì‹¤ìš©ì ì¸ Tool - ë‚ ì”¨")
    print("=" * 70)

    cities = ["ì„œìš¸", "ë¶€ì‚°", "ë‰´ìš•", "íŒŒë¦¬"]

    for city in cities:
        result = get_weather.invoke({"city": city})
        print(f"\nğŸŒ¤ï¸  {result}")

    print()


# ============================================================================
# ì˜ˆì œ 4: ì—¬ëŸ¬ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” Tool
# ============================================================================

@tool
def search_web(query: str, max_results: int = 5) -> str:
    """ì›¹ì—ì„œ ì •ë³´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.

    Args:
        query: ê²€ìƒ‰ì–´
        max_results: ìµœëŒ€ ê²°ê³¼ ê°œìˆ˜ (ê¸°ë³¸ê°’: 5)
    """
    # ì‹¤ì œë¡œëŠ” ê²€ìƒ‰ APIë¥¼ í˜¸ì¶œ
    return f"'{query}'ì— ëŒ€í•œ ìƒìœ„ {max_results}ê°œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤."


def example_4_multiple_params():
    """ì—¬ëŸ¬ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” ë„êµ¬"""
    print("=" * 70)
    print("ğŸ“Œ ì˜ˆì œ 4: ì—¬ëŸ¬ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” Tool")
    print("=" * 70)

    # ê¸°ë³¸ê°’ ì‚¬ìš©
    result1 = search_web.invoke({"query": "LangChain"})
    print(f"\nğŸ” {result1}")

    # ì»¤ìŠ¤í…€ max_results
    result2 = search_web.invoke({"query": "Python", "max_results": 10})
    print(f"ğŸ” {result2}\n")


# ============================================================================
# ì˜ˆì œ 5: Tool ì—ëŸ¬ í•¸ë“¤ë§
# ============================================================================

@tool
def divide_numbers(a: float, b: float) -> str:
    """ë‘ ìˆ«ìë¥¼ ë‚˜ëˆ•ë‹ˆë‹¤.

    Args:
        a: ë¶„ì
        b: ë¶„ëª¨
    """
    try:
        result = a / b
        return f"{a} Ã· {b} = {result}"
    except ZeroDivisionError:
        return "ì˜¤ë¥˜: 0ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    except Exception as e:
        return f"ì˜¤ë¥˜: {str(e)}"


def example_5_error_handling():
    """ë„êµ¬ì˜ ì—ëŸ¬ í•¸ë“¤ë§"""
    print("=" * 70)
    print("ğŸ“Œ ì˜ˆì œ 5: Tool ì—ëŸ¬ í•¸ë“¤ë§")
    print("=" * 70)

    # ì •ìƒ ì¼€ì´ìŠ¤
    result1 = divide_numbers.invoke({"a": 10, "b": 2})
    print(f"\nâœ… {result1}")

    # ì—ëŸ¬ ì¼€ì´ìŠ¤
    result2 = divide_numbers.invoke({"a": 10, "b": 0})
    print(f"âŒ {result2}\n")


# ============================================================================
# ë©”ì¸ ì‹¤í–‰
# ============================================================================

def main():
    print("\nğŸ“ Part 2: LangChain ê¸°ì´ˆ - Tools (ê¸°ì´ˆ)\n")

    example_1_simple_tool()
    input("â ê³„ì†í•˜ë ¤ë©´ Enter...")

    example_2_tool_with_params()
    input("â ê³„ì†í•˜ë ¤ë©´ Enter...")

    example_3_practical_tool()
    input("â ê³„ì†í•˜ë ¤ë©´ Enter...")

    example_4_multiple_params()
    input("â ê³„ì†í•˜ë ¤ë©´ Enter...")

    example_5_error_handling()

    print("=" * 70)
    print("ğŸ‰ Tools ê¸°ì´ˆ í•™ìŠµ ì™„ë£Œ!")
    print("ğŸ“– ë‹¤ìŒ: 04_tools_advanced.py - ê³ ê¸‰ Tool ì‚¬ìš©ë²•")
    print("=" * 70 + "\n")


if __name__ == "__main__":
    main()


# ============================================================================
# ğŸ“š í•µì‹¬ í¬ì¸íŠ¸
# ============================================================================
#
# 1. @tool ë°ì½”ë ˆì´í„°:
#    - ì¼ë°˜ í•¨ìˆ˜ë¥¼ LangChain Toolë¡œ ë³€í™˜
#    - docstringì´ Tool ì„¤ëª…ì´ ë¨ (ì¤‘ìš”!)
#    - íƒ€ì… íŒíŠ¸ë¡œ íŒŒë¼ë¯¸í„° ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±
#
# 2. Tool ì„¤ëª… ì‘ì„± íŒ:
#    - ëª…í™•í•˜ê³  êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±
#    - LLMì´ ì–¸ì œ ì´ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë„ë¡
#    - Args ì„¹ì…˜ì— íŒŒë¼ë¯¸í„° ì„¤ëª…
#
# 3. Agentì™€ í•¨ê»˜ ì‚¬ìš©:
#    Part 3ì—ì„œ ì´ ë„êµ¬ë“¤ì„ Agentì— ì—°ê²°í•©ë‹ˆë‹¤!
#
# ============================================================================
