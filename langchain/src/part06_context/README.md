# Part 6: Context Engineering - ë™ì  ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬

> ğŸ“š **í•™ìŠµ ì‹œê°„**: ì•½ 3-4ì‹œê°„
> ğŸ¯ **ë‚œì´ë„**: â­â­â­â­â˜† (ê³ ê¸‰)
> ğŸ“– **ê³µì‹ ë¬¸ì„œ**: [19-context-engineering.md](/official/19-context-engineering.md), [18-runtime.md](/official/18-runtime.md)
> ğŸ“„ **êµì•ˆ ë¬¸ì„œ**: [part06_context.md](/docs/part06_context.md)
> ğŸ¯ **ë¯¸ë‹ˆ í”„ë¡œì íŠ¸**: [Document Q&A](/projects/02_document_qa/)

---

## ğŸ“‹ í•™ìŠµ ëª©í‘œ

ì´ íŒŒíŠ¸ë¥¼ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- [x] Context Engineeringì˜ ê°œë… ì´í•´
- [x] ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„± (ì‚¬ìš©ì/ì‹œê°„ ê¸°ë°˜)
- [x] ë™ì  ë„êµ¬ ì„ íƒ (ìƒí™©ë³„ ë„êµ¬ ì œê³µ)
- [x] ë™ì  ëª¨ë¸ ì„ íƒ (ì‘ì—…ë³„ ìµœì  ëª¨ë¸)
- [x] ToolRuntimeìœ¼ë¡œ Agent ì»¨í…ìŠ¤íŠ¸ ì ‘ê·¼
- [x] Context Injection íŒ¨í„´

---

## ğŸ“š ê°œìš”

**Context Engineering**ì€ Agentì—ê²Œ ì œê³µí•˜ëŠ” ì •ë³´ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì •í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ í”„ë¡¬í”„íŠ¸, ë„êµ¬, ëª¨ë¸ì„ ë³€ê²½í•˜ì—¬ ë” ë˜‘ë˜‘í•œ Agentë¥¼ ë§Œë“­ë‹ˆë‹¤.

**ì™œ ì¤‘ìš”í•œê°€?**
- ì •ì  ì„¤ì •ì˜ í•œê³„ ê·¹ë³µ
- ì‚¬ìš©ìë³„, ìƒí™©ë³„ ë§ì¶¤í˜• Agent
- ë¦¬ì†ŒìŠ¤ ìµœì í™” (í•„ìš”í•œ ë„êµ¬ë§Œ ì œê³µ)

**ì‹¤ë¬´ í™œìš© ì‚¬ë¡€**
- ì‚¬ìš©ì ê¶Œí•œì— ë”°ë¥¸ ë„êµ¬ ì œí•œ
- ì‹œê°„ëŒ€ë³„ ë‹¤ë¥¸ í”„ë¡¬í”„íŠ¸
- ì‘ì—… ë³µì¡ë„ì— ë”°ë¥¸ ëª¨ë¸ ì„ íƒ

---

## ğŸ“ ì˜ˆì œ íŒŒì¼

### 01_context_overview.py
**ë‚œì´ë„**: â­â­â­â˜†â˜† | **ì˜ˆìƒ ì‹œê°„**: 30ë¶„

Context Engineeringì˜ 3ê°€ì§€ ì£¼ìš” íƒ€ì…ì„ ê°œê´„ì ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- Model Context (í”„ë¡¬í”„íŠ¸)
- Tool Context (ë„êµ¬)
- Runtime Context (ì‹¤í–‰ í™˜ê²½)
- ì–¸ì œ ë¬´ì—‡ì„ ì‚¬ìš©í• ì§€

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 01_context_overview.py
```

**ì£¼ìš” ê°œë…**:
- **Model Context**: í”„ë¡¬í”„íŠ¸ ë™ì  ìƒì„±
- **Tool Context**: ë„êµ¬ ë™ì  ì„ íƒ
- **Runtime Context**: ì‹¤í–‰ ì‹œ ì •ë³´ ì ‘ê·¼

---

### 02_dynamic_prompt.py
**ë‚œì´ë„**: â­â­â­â˜†â˜† | **ì˜ˆìƒ ì‹œê°„**: 40ë¶„

ì‚¬ìš©ì ì •ë³´, ì‹œê°„ ë“±ì— ë”°ë¼ í”„ë¡¬í”„íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- Prompt Template í™œìš©
- ì‚¬ìš©ì í”„ë¡œí•„ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸
- ì‹œê°„/ë‚ ì§œ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸
- Few-shot ì˜ˆì‹œ ë™ì  ì‚½ì…

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 02_dynamic_prompt.py
```

**ì£¼ìš” ê°œë…**:
- í•˜ë“œì½”ë”© ëŒ€ì‹  í…œí”Œë¦¿ ì‚¬ìš©
- ì»¨í…ìŠ¤íŠ¸ ë³€ìˆ˜ ì£¼ì…
- ì¡°ê±´ë¶€ í”„ë¡¬í”„íŠ¸

---

### 03_dynamic_tools.py
**ë‚œì´ë„**: â­â­â­â­â˜† | **ì˜ˆìƒ ì‹œê°„**: 50ë¶„

ìƒí™©ì— ë”°ë¼ Agentì—ê²Œ ì œê³µí•˜ëŠ” ë„êµ¬ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- ë„êµ¬ í’€(Pool) ê´€ë¦¬
- ì‚¬ìš©ì ê¶Œí•œì— ë”°ë¥¸ ë„êµ¬ í•„í„°ë§
- ì‘ì—… íƒ€ì…ì— ë”°ë¥¸ ë„êµ¬ ì„ íƒ
- ë„êµ¬ ê°œìˆ˜ ìµœì í™”

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 03_dynamic_tools.py
```

**ì£¼ìš” ê°œë…**:
- ëª¨ë“  ë„êµ¬ë¥¼ í•­ìƒ ì œê³µí•˜ë©´ LLMì´ í˜¼ë€
- ìƒí™©ë³„ ìµœì†Œí•œì˜ ë„êµ¬ë§Œ ì œê³µ
- ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´

---

### 04_dynamic_model.py
**ë‚œì´ë„**: â­â­â­â­â˜† | **ì˜ˆìƒ ì‹œê°„**: 45ë¶„

ì‘ì—…ì˜ ë³µì¡ë„ë‚˜ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ëª¨ë¸ì„ ë™ì ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- ëª¨ë¸ ë¼ìš°íŒ… ì „ëµ
- ê°„ë‹¨í•œ ì‘ì—… â†’ ì €ë ´í•œ ëª¨ë¸
- ë³µì¡í•œ ì‘ì—… â†’ ê°•ë ¥í•œ ëª¨ë¸
- í´ë°± ì „ëµ

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 04_dynamic_model.py
```

**ì£¼ìš” ê°œë…**:
- **ë¹„ìš© ìµœì í™”**: ê³¼í•˜ê²Œ ê°•ë ¥í•œ ëª¨ë¸ í”¼í•˜ê¸°
- **ì„±ëŠ¥ ìµœì í™”**: ë¹ ë¥¸ ëª¨ë¸ ìš°ì„  ì‚¬ìš©
- **í’ˆì§ˆ ë³´ì¥**: í•„ìš” ì‹œ ì—…ê·¸ë ˆì´ë“œ

---

### 05_tool_runtime.py
**ë‚œì´ë„**: â­â­â­â­â˜† | **ì˜ˆìƒ ì‹œê°„**: 50ë¶„

ToolRuntimeì„ ì‚¬ìš©í•˜ì—¬ ë„êµ¬ ë‚´ë¶€ì—ì„œ Agentì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ì ‘ê·¼í•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- `ToolRuntime` ê°ì²´
- ë„êµ¬ì—ì„œ State ì½ê¸°
- ë„êµ¬ì—ì„œ Store ì ‘ê·¼
- Thread ID, User ID ë“± ë©”íƒ€ë°ì´í„°

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 05_tool_runtime.py
```

**ì£¼ìš” ê°œë…**:
- ë„êµ¬ê°€ Agent ìƒíƒœë¥¼ ì•Œ ìˆ˜ ìˆìŒ
- ì‚¬ìš©ìë³„ ë§ì¶¤ ë™ì‘
- ë„êµ¬ ê°„ ì •ë³´ ê³µìœ 

---

### 06_context_injection.py
**ë‚œì´ë„**: â­â­â­â­â˜† | **ì˜ˆìƒ ì‹œê°„**: 60ë¶„

ì˜ì¡´ì„± ì£¼ì…(DI) íŒ¨í„´ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

**í•™ìŠµ ë‚´ìš©**:
- Context ê°ì²´ ì„¤ê³„
- ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´
- ê¹”ë”í•œ ì½”ë“œ êµ¬ì¡°
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„±

**ì‹¤í–‰ ë°©ë²•**:
```bash
python 06_context_injection.py
```

**ì£¼ìš” ê°œë…**:
- ì „ì—­ ë³€ìˆ˜ ëŒ€ì‹  ëª…ì‹œì  ì£¼ì…
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸
- ëª¨ì˜ ê°ì²´(Mock)ë¡œ í…ŒìŠ¤íŠ¸

---

## ğŸ“ ì‹¤ìŠµ ê³¼ì œ

### ê³¼ì œ 1: ì‹œê°„ëŒ€ë³„ Agent (â­â­â­)

**ëª©í‘œ**: ì‹œê°„ëŒ€ì— ë”°ë¼ ë‹¤ë¥¸ ì¸ì‚¬ë§ê³¼ ë„êµ¬ë¥¼ ì œê³µí•˜ëŠ” Agentë¥¼ ë§Œë“œì„¸ìš”.

**ìš”êµ¬ì‚¬í•­**:
1. ì˜¤ì „: "ì¢‹ì€ ì•„ì¹¨ì…ë‹ˆë‹¤" + ë‰´ìŠ¤ ë„êµ¬
2. ì˜¤í›„: "ì¢‹ì€ ì˜¤í›„ì…ë‹ˆë‹¤" + ë‚ ì”¨ ë„êµ¬
3. ì €ë…: "ì¢‹ì€ ì €ë…ì…ë‹ˆë‹¤" + ë ˆìŠ¤í† ë‘ ì¶”ì²œ ë„êµ¬

**í•´ë‹µ**: [solutions/exercise_01.py](/src/part06_context/solutions/exercise_01.py)

---

### ê³¼ì œ 2: ê¶Œí•œ ê¸°ë°˜ Agent (â­â­â­â­)

**ëª©í‘œ**: ì‚¬ìš©ì ê¶Œí•œì— ë”°ë¼ ë‹¤ë¥¸ ë„êµ¬ë¥¼ ì œê³µí•˜ëŠ” Agentë¥¼ ë§Œë“œì„¸ìš”.

**ìš”êµ¬ì‚¬í•­**:
1. **ì¼ë°˜ ì‚¬ìš©ì**: ê²€ìƒ‰, ê³„ì‚°ê¸°
2. **í”„ë¦¬ë¯¸ì—„ ì‚¬ìš©ì**: + ë°ì´í„° ë¶„ì„
3. **ê´€ë¦¬ì**: + ë°ì´í„°ë² ì´ìŠ¤ ì“°ê¸°, ì‹œìŠ¤í…œ ì„¤ì •

**í•´ë‹µ**: [solutions/exercise_02.py](/src/part06_context/solutions/exercise_02.py)

---

### ê³¼ì œ 3: ì ì‘í˜• Agent (â­â­â­â­â­)

**ëª©í‘œ**: ì‘ì—… ë³µì¡ë„ë¥¼ ìë™ íŒë‹¨í•˜ì—¬ ëª¨ë¸ì„ ì„ íƒí•˜ëŠ” Agentë¥¼ ë§Œë“œì„¸ìš”.

**ìš”êµ¬ì‚¬í•­**:
1. ì§ˆë¬¸ ë¶„ì„ â†’ ë³µì¡ë„ ì ìˆ˜ (1-10)
2. ì ìˆ˜ 1-3: GPT-4o-mini
3. ì ìˆ˜ 4-7: GPT-4o
4. ì ìˆ˜ 8-10: Claude 3.5 Sonnet
5. ì‹¤íŒ¨ ì‹œ ë” ê°•ë ¥í•œ ëª¨ë¸ë¡œ ì¬ì‹œë„

**í•´ë‹µ**: [solutions/exercise_03.py](/src/part06_context/solutions/exercise_03.py)

---

## ğŸ’¡ ì‹¤ì „ íŒ

### Tip 1: í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ê´€ë¦¬

```python
from string import Template

PROMPT_TEMPLATE = Template("""
ë‹¹ì‹ ì€ ${user_name}ë‹˜ì˜ ê°œì¸ ë¹„ì„œì…ë‹ˆë‹¤.
í˜„ì¬ ì‹œê°„: ${current_time}
ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥: ${available_features}

${special_instructions}
""")

# ë™ì  ìƒì„±
prompt = PROMPT_TEMPLATE.substitute(
    user_name="ê¹€ì² ìˆ˜",
    current_time="2025-02-06 14:30",
    available_features="ê²€ìƒ‰, ê³„ì‚°ê¸°, ë‚ ì”¨",
    special_instructions="ì˜¤ëŠ˜ì€ ì£¼ë§ì´ë‹ˆ ì—¬ìœ ë¡­ê²Œ ë‹µë³€í•˜ì„¸ìš”."
)
```

### Tip 2: ë„êµ¬ ì„ íƒ ì „ëµ

```python
def select_tools(user_role: str, task_type: str) -> list:
    """ì‚¬ìš©ì ì—­í• ê³¼ ì‘ì—… íƒ€ì…ì— ë”°ë¼ ë„êµ¬ ì„ íƒ"""

    # ê¸°ë³¸ ë„êµ¬ (ëª¨ë‘ì—ê²Œ)
    tools = [search_tool, calculator]

    # í”„ë¦¬ë¯¸ì—„ ì‚¬ìš©ì
    if user_role in ["premium", "admin"]:
        tools.append(advanced_analytics)

    # ê´€ë¦¬ìë§Œ
    if user_role == "admin":
        tools.extend([database_write, system_config])

    # ì‘ì—…ë³„ ì¶”ê°€
    if task_type == "data_analysis":
        tools.append(data_visualization)

    return tools
```

### Tip 3: ëª¨ë¸ ë¼ìš°íŒ…

```python
def route_model(complexity: int, budget: float):
    """ë³µì¡ë„ì™€ ì˜ˆì‚°ì— ë”°ë¼ ëª¨ë¸ ì„ íƒ"""

    if budget < 0.01:  # ë‚®ì€ ì˜ˆì‚°
        return ChatOpenAI(model="gpt-4o-mini")
    elif complexity < 5:  # ê°„ë‹¨í•œ ì‘ì—…
        return ChatOpenAI(model="gpt-4o-mini")
    elif complexity < 8:  # ì¤‘ê°„ ë³µì¡ë„
        return ChatOpenAI(model="gpt-4o")
    else:  # ê³ ë„ë¡œ ë³µì¡í•œ ì‘ì—…
        return ChatAnthropic(model="claude-3-5-sonnet-20241022")
```

---

## â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸

<details>
<summary>Q1: ë™ì  í”„ë¡¬í”„íŠ¸ vs ì •ì  í”„ë¡¬í”„íŠ¸</summary>

**A**:
- **ì •ì **: ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë™ì¼, ê°„ë‹¨í•¨
- **ë™ì **: ì‚¬ìš©ì/ìƒí™©ë³„ ë§ì¶¤, ë” íš¨ê³¼ì 

**ì–¸ì œ ë™ì ìœ¼ë¡œ?**
- ë‹¤ì–‘í•œ ì‚¬ìš©ì íƒ€ì…
- ì‹œê°„ëŒ€ë³„ ë™ì‘ ë³€ê²½
- ê°œì¸í™” í•„ìš”

```python
# ì •ì 
PROMPT = "ë‹¹ì‹ ì€ ë„ì›€ì´ ë˜ëŠ” AIì…ë‹ˆë‹¤."

# ë™ì 
def get_prompt(user):
    return f"ë‹¹ì‹ ì€ {user.name}ë‹˜ì˜ {user.role} ì „ë¬¸ AIì…ë‹ˆë‹¤."
```
</details>

<details>
<summary>Q2: ToolRuntimeì€ ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?</summary>

**A**: ë„êµ¬ê°€ Agentì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì•Œì•„ì•¼ í•  ë•Œ:
- ì‚¬ìš©ì ì •ë³´ (ì´ë¦„, ê¶Œí•œ)
- ëŒ€í™” ì´ë ¥
- ë‹¤ë¥¸ ë„êµ¬ì˜ ê²°ê³¼
- Thread ID, Namespace

```python
from langchain_core.tools import tool, ToolRuntime

@tool
def personalized_greeting(runtime: ToolRuntime) -> str:
    """ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ì¸ì‚¬"""
    user_name = runtime.config.get("user_name", "ê³ ê°")
    return f"ì•ˆë…•í•˜ì„¸ìš”, {user_name}ë‹˜!"
```
</details>

<details>
<summary>Q3: ë„êµ¬ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?</summary>

**A**: LLMì´ í˜¼ë€ìŠ¤ëŸ¬ì›Œì§‘ë‹ˆë‹¤:
- ì˜ëª»ëœ ë„êµ¬ ì„ íƒ
- ì‘ë‹µ ì‹œê°„ ì¦ê°€
- ë¹„ìš© ì¦ê°€

**í•´ê²°ì±…**: ë™ì  ë„êµ¬ ì„ íƒ
- ì‘ì—…ë³„ í•„ìš”í•œ ë„êµ¬ë§Œ ì œê³µ
- ìµœëŒ€ 5-10ê°œ ë„êµ¬ ê¶Œì¥
- ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹í™”
</details>

---

## ğŸš€ ë¯¸ë‹ˆ í”„ë¡œì íŠ¸

### Project 2: Document Q&A System

Context Engineeringì„ í™œìš©í•œ ë¬¸ì„œ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë³´ì„¸ìš”!

**í”„ë¡œì íŠ¸ ë§í¬**: [Document Q&A](/projects/02_document_qa/)

**ì£¼ìš” ê¸°ëŠ¥**:
- ë¬¸ì„œ íƒ€ì…ë³„ ë‹¤ë¥¸ ì²˜ë¦¬ ì „ëµ
- ì‚¬ìš©ì ê¶Œí•œë³„ ë¬¸ì„œ ì ‘ê·¼ ì œì–´
- ì§ˆë¬¸ ë³µì¡ë„ì— ë”°ë¥¸ ëª¨ë¸ ì„ íƒ
- ë™ì  í”„ë¡¬í”„íŠ¸ë¡œ ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸ ì œê³µ

**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 3-4ì‹œê°„
**ë‚œì´ë„**: â­â­â­â­â˜†

---

## ğŸ”— ì‹¬í™” í•™ìŠµ

1. **ê³µì‹ ë¬¸ì„œ ì‹¬í™”**
   - [19-context-engineering.md](/official/19-context-engineering.md) - Context Engineering
   - [18-runtime.md](/official/18-runtime.md) - Runtime ê°ì²´
   - [09-tools.md](/official/09-tools.md#toolruntime) - ToolRuntime

2. **ê´€ë ¨ ê°œë…**
   - Dependency Injection (DI)
   - Strategy Pattern
   - Factory Pattern

3. **ì»¤ë®¤ë‹ˆí‹° ë¦¬ì†ŒìŠ¤**
   - [Dynamic Agent Configuration](https://python.langchain.com/docs/how_to/dynamic_agents/)
   - [Context-Aware Systems](https://blog.langchain.dev/context-aware-systems/)

4. **ë‹¤ìŒ ë‹¨ê³„**
   - [Part 7: Multi-Agent](/src/part07_multi_agent/README.md) - ì—¬ëŸ¬ Agent í˜‘ì—…

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

Part 6ì„ ì™„ë£Œí•˜ê¸° ì „ì— í™•ì¸í•˜ì„¸ìš”:

- [ ] ëª¨ë“  ì˜ˆì œ ì½”ë“œë¥¼ ì‹¤í–‰í•´ë´¤ë‹¤ (6ê°œ)
- [ ] ì‹¤ìŠµ ê³¼ì œë¥¼ ì™„ë£Œí–ˆë‹¤ (3ê°œ)
- [ ] Context Engineeringì˜ 3ê°€ì§€ íƒ€ì…ì„ ì´í•´í–ˆë‹¤
- [ ] ë™ì  í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤
- [ ] ë™ì ìœ¼ë¡œ ë„êµ¬ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤
- [ ] ToolRuntimeì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- [ ] ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ì„ ì´í•´í–ˆë‹¤

---

**ì´ì „**: [â† Part 5 - Middleware](/src/part05_middleware/README.md)
**ë‹¤ìŒ**: [Part 7 - Multi-Agentë¡œ ì´ë™](/src/part07_multi_agent/README.md) â†’

---

**í•™ìŠµ ì§„ë„**: â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘ 60% (Part 6/10 ì™„ë£Œ)

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-02-06*
